Optimization from previous version to support gpu up to rtx30 series
